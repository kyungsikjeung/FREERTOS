<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RTOS: FreeRTOS Mailbox Queue Example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RTOS<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<div id="main-nav">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- main-nav -->
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">FreeRTOS Mailbox Queue Example </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md91"></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md92"></a>
1.목적 (Objective)</h1>
<p>FreeRTOS의 <span class="tt"><a class="el" href="queue_8h.html#a8e9ced123b5a0e37a36d3bbdb2e56b4e">xQueueOverwrite()</a></span>와 <span class="tt"><a class="el" href="queue_8h.html#a3f9e430276fe5244417fd82644ec8a75">xQueuePeek()</a></span> API를 사용하여 <br  />
 <span class="tt">가장 최신 데이터만 가져오는 큐(메일박스)를 테스트</p><ul>
<li>송신 Task는 주기적으로 값과 타임스탬프를 큐에 </li>
</ul>
<p></span>덮어쓰기(xQueueOverwrite)<span class="tt"> 방식으로 전송합니다.</p><ul>
<li>수신 Task는 </li>
</ul>
<p></span><a class="el" href="queue_8h.html#a3f9e430276fe5244417fd82644ec8a75">xQueuePeek()</a><span class="tt">을 통해 큐의 내용을 읽고, 마지막으로 받은 timestamp와 비교하여 </span>중복 출력 방지` 처리를 합니다.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md94"></a>
2.시스템 구성</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Task 이름  </th><th class="markdownTableHeadNone">역할  </th><th class="markdownTableHeadNone">주요 API 사용  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">vUpdaterTask</span>  </td><td class="markdownTableBodyNone">주기적으로 값 증가 후 Mailbox에 덮어쓰기  </td><td class="markdownTableBodyNone"><span class="tt"><a class="el" href="queue_8h.html#a8e9ced123b5a0e37a36d3bbdb2e56b4e">xQueueOverwrite()</a></span>  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">vReaderTask</span>  </td><td class="markdownTableBodyNone">Mailbox에서 최신 값만 확인하고 출력  </td><td class="markdownTableBodyNone"><span class="tt"><a class="el" href="queue_8h.html#a3f9e430276fe5244417fd82644ec8a75">xQueuePeek()</a></span> + 타임스탬프 비교  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md96"></a>
3.동작 시나리오</h1>
<ol type="1">
<li>시스템 초기화 후 길이 1의 큐(<span class="tt">xMailbox</span>)가 생성됨</li>
<li><span class="tt">vUpdaterTask</span>가 값과 Tick을 주기적으로 <span class="tt"><a class="el" href="queue_8h.html#a8e9ced123b5a0e37a36d3bbdb2e56b4e">xQueueOverwrite()</a></span>로 큐에 기록</li>
<li><span class="tt">vReaderTask</span>는 <span class="tt"><a class="el" href="queue_8h.html#a3f9e430276fe5244417fd82644ec8a75">xQueuePeek()</a></span>으로 데이터를 읽음</li>
<li>이전에 수신한 timestamp와 비교하여 중복 데이터는 무시, 새로운 데이터만 출력</li>
</ol>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md98"></a>
4.핵심 포인트</h1>
<ul>
<li>일반적인 큐는 가득 차면 전송 실패 (<span class="tt"><a class="el" href="queue_8h.html#af7eb49d3249351176992950d9185abe9">xQueueSend()</a></span> → FAIL)</li>
<li><span class="tt"><a class="el" href="queue_8h.html#a8e9ced123b5a0e37a36d3bbdb2e56b4e">xQueueOverwrite()</a></span>는 큐 길이에 상관없이 <b>기존 데이터를 덮어쓰기</b> 때문에 <br  />
 <b>항상 최신 데이터만 유지**하는 데 적합</b></li>
<li><b><span class="tt"><a class="el" href="queue_8h.html#a3f9e430276fe5244417fd82644ec8a75">xQueuePeek()</a></span>은 데이터를 **제거하지 않고 읽기만</b> 하므로 <br  />
 수신자가 데이터의 변화를 감지하고 처리 가능</li>
</ul>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md100"></a>
5.출력 예시 (UART 로그)</h1>
<div class="fragment"><div class="line">Received value: 3 (Tick: 12345)</div>
<div class="line">Received value: 4 (Tick: 12845)</div>
<div class="line">Received value: 5 (Tick: 13345)</div>
</div><!-- fragment --><h1 class="doxsection"><a class="anchor" id="autotoc_md101"></a>
6.PlantUML 시퀀스 다이어그램</h1>
<div class="fragment"><div class="line">@startuml</div>
<div class="line"> </div>
<div class="line">participant UpdaterTask</div>
<div class="line">participant xMailbox</div>
<div class="line">participant ReaderTask</div>
<div class="line"> </div>
<div class="line">loop every 500ms</div>
<div class="line">    UpdaterTask -&gt; xMailbox : xQueueOverwrite(dataToSend)</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">loop every 100ms</div>
<div class="line">    ReaderTask -&gt; xMailbox : xQueuePeek(receivedData)</div>
<div class="line">    alt if receivedData.timestamp is new</div>
<div class="line">        ReaderTask -&gt; UART : printf(receivedData)</div>
<div class="line">    else</div>
<div class="line">        ReaderTask --&gt; ReaderTask : Skip (duplicate)</div>
<div class="line">    end</div>
<div class="line">end</div>
<div class="line"> </div>
<div class="line">@enduml</div>
</div><!-- fragment --><p> 🧪 응용 가능성 센서 데이터 수집 시 최근값만 유지 UI에 최신 상태만 반영 (ex. 온도, 속도, 위치 등) CAN, UART 등에서 단일 ID에 해당하는 최신 메시지 처리용 ⚠️ 주의 과거 기록이 필요한 경우 사용하지 말것(Fault Log) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
