\doxysection{5\+\_\+1\+\_\+interrupt\+\_\+timerdaemmon.\+c}
\hypertarget{5__1__interrupt__timerdaemmon_8c_source}{}\label{5__1__interrupt__timerdaemmon_8c_source}\index{C:/Users/TOVIS/test/TestRtos/Core/Src/MainProgram/5\_1\_interrupt\_timerdaemmon.c@{C:/Users/TOVIS/test/TestRtos/Core/Src/MainProgram/5\_1\_interrupt\_timerdaemmon.c}}
\mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{main_8h}{main.h}}"{}}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00002}00002\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{driver__init_8h}{driver\_init.h}}"{}}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00005}00005\ \textcolor{comment}{/*\ }}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00006}00006\ \textcolor{comment}{@objective\ :\ 인터럽트\ 발생\ 시,\ 현재\ Task가\ 끝난\ 뒤에\ 실행되도록\ 지연된\ 함수\ 호출을\ 사용하여\ 인터럽트\ 처리\ }}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00007}00007\ \textcolor{comment}{@description\ :\ vPeriodicTask()\ 실행\ 중}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00008}00008\ \textcolor{comment}{→\ HAL\_NVIC\_SetPendingIRQ()로\ 강제\ 인터럽트\ 발생}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00009}00009\ \textcolor{comment}{EXTI15\_10\_IRQHandler()\ 실행}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00010}00010\ \textcolor{comment}{→\ xTimerPendFunctionCallFromISR()\ 호출}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00011}00011\ \textcolor{comment}{→\ 요청만\ 큐에\ 넣고\ 실행은\ 안\ 함}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00012}00012\ \textcolor{comment}{→\ portYIELD\_FROM\_ISR()로\ 컨텍스트\ 스위칭\ 요청}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00013}00013\ \textcolor{comment}{vPeriodicTask()는\ vTaskDelay()로\ Block\ 상태로\ 진입함}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00014}00014\ \textcolor{comment}{→\ 스케줄러가\ 우선순위\ 높은\ Task가\ 있나\ 확인}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00015}00015\ \textcolor{comment}{이제\ 우선순위가\ 더\ 높은\ Timer\ Service\ Task가\ Ready\ 상태이므로}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00016}00016\ \textcolor{comment}{→\ Context\ Switch\ 발생\ →\ Timer\ Task가\ 실행됨}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00017}00017\ \textcolor{comment}{Timer\ Task가\ 큐에\ 등록된\ vDeferredHandlingFunction()을\ 그제서야\ 실행함}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00018}00018\ \textcolor{comment}{*/}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00020}00020\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00021}00021\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a59963d19b60052661ffcca0eccdc1244}{vPeriodicTask}}(\textcolor{keywordtype}{void}\ *pvParameters);}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00022}00022\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ vDeferredHandlingFunction(\textcolor{keywordtype}{void}\ *pvParam1,\ uint32\_t\ ulParam2);}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00023}00023\ \textcolor{keyword}{static}\ uint32\_t\ ulParamCounter\ =\ 0;}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00024}00024\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00025}\mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a738473a5b43f6c92b80ce1d3d6f77ed9}{00025}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a738473a5b43f6c92b80ce1d3d6f77ed9}{EXTI15\_10\_IRQHandler}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00026}00026\ \{}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00027}00027\ \ \ \ \ \mbox{\hyperlink{portmacro_8h_a46fb21e00ae0729d7515c0fbf2269796}{BaseType\_t}}\ xHigherPriorityTaskWoken\ =\ \mbox{\hyperlink{projdefs_8h_aa56260e937e7e203026707e5ba944273}{pdFALSE}};}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00028}00028\ \ \ \ \ \textcolor{comment}{//\ Timer\ Task\ 우선순위\ ≤\ 현재\ Task\ -\/\ 현재\ Task\ 끝난\ 뒤\ 실행됨\ (지연됨)}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00029}00029\ \ \ \ \ \mbox{\hyperlink{timers_8h_ae0d9338933037e6feebe6437763fa299}{xTimerPendFunctionCallFromISR}}(}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00030}00030\ \ \ \ \ \ \ \ \ vDeferredHandlingFunction,\ \textcolor{comment}{//\ 실행할\ 함수}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00031}00031\ \ \ \ \ \ \ \ \ NULL,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 파라미터\ 1\ (사용\ 안\ 함)}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00032}00032\ \ \ \ \ \ \ \ \ ulParamCounter++,\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 파라미터\ 2\ (카운터\ 증가)}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00033}00033\ \ \ \ \ \ \ \ \ \&xHigherPriorityTaskWoken\ \ \textcolor{comment}{//\ 우선순위\ 전환\ 요청}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00034}00034\ \ \ \ \ );}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00035}00035\ \ \ \ \ \mbox{\hyperlink{portmacro_8h_aac6850c66595efdc02a8bbb95fb4648e}{portYIELD\_FROM\_ISR}}(xHigherPriorityTaskWoken);}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00036}00036\ \ \ \ \ \mbox{\hyperlink{group___g_p_i_o___exported___macros_ga2a086506eec826f49b200fba64beb9f1}{\_\_HAL\_GPIO\_EXTI\_CLEAR\_IT}}(\mbox{\hyperlink{group___g_p_i_o__pins__define_ga173023dced8f9692ade0f1176558ef70}{GPIO\_PIN\_13}});\ \textcolor{comment}{//\ 예:\ 버튼\ 인터럽트\ 클리어}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00037}00037\ \}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00039}00039\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ vDeferredHandlingFunction(\textcolor{keywordtype}{void}\ *pvParam1,\ uint32\_t\ ulParam2)}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00040}00040\ \{}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00041}00041\ \ \ \ \ printf(\textcolor{stringliteral}{"{}인터럽트\ 처리\ 위임됨:\ Param\ =\ \%lu\(\backslash\)r\(\backslash\)n"{}},\ ulParam2);}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00042}00042\ \}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00044}00044\ \textcolor{comment}{/*\ 500ms\ 마다\ 인터럽트\ 소프트웨어\ 발생\ */}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00045}\mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a59963d19b60052661ffcca0eccdc1244}{00045}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a59963d19b60052661ffcca0eccdc1244}{vPeriodicTask}}(\textcolor{keywordtype}{void}\ *pvParameters)}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00046}00046\ \{}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00047}00047\ \ \ \ \ \textcolor{keywordflow}{while}\ (1)}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00048}00048\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00049}00049\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Periodic\ Task\ 실행\ 중...\(\backslash\)r\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00050}00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group___c_o_r_t_e_x___exported___functions___group2_gaecf50f6c6d0e1fa5f8bd8c1b45309f18}{HAL\_NVIC\_SetPendingIRQ}}(\mbox{\hyperlink{group___peripheral__interrupt__number__definition_gga7e1129cd8a196f4284d41db3e82ad5c8a9fb0ad0c850234d1983fafdb17378e2f}{EXTI15\_10\_IRQn}});\ \textcolor{comment}{//\ 인터럽트\ 발생}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00051}00051\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{task_8h_aa154068cecd7f31446a7a84af44ab1a3}{vTaskDelay}}(\mbox{\hyperlink{projdefs_8h_a353d0f62b82a402cb3db63706c81ec3f}{pdMS\_TO\_TICKS}}(500));\ \textcolor{comment}{//\ 500ms\ 대기}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00052}00052\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00053}00053\ \}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00054}00054\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00055}\mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a840291bc02cba5474a4cb46a9b9566fe}{00055}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a840291bc02cba5474a4cb46a9b9566fe}{main}}(\textcolor{keywordtype}{void})}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00056}00056\ \{}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00057}00057\ \ \ \ \ \mbox{\hyperlink{driver__init_8h_aab7f079e70f08c868bbb3fdd41b86f82}{Driver\_Init}}();}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00058}00058\ \ \ \ \ \textcolor{comment}{//\ 인터럽트\ Enable}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00059}00059\ \ \ \ \ \mbox{\hyperlink{group___c_o_r_t_e_x___exported___functions___group1_ga8581a82025a4780efd00876a66e3e91b}{HAL\_NVIC\_SetPriority}}(\mbox{\hyperlink{group___peripheral__interrupt__number__definition_gga7e1129cd8a196f4284d41db3e82ad5c8a9fb0ad0c850234d1983fafdb17378e2f}{EXTI15\_10\_IRQn}},\ 5,\ 0);}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00060}00060\ \ \ \ \ \mbox{\hyperlink{group___c_o_r_t_e_x___exported___functions___group1_gaaad4492c1b25e006d69948a15790352a}{HAL\_NVIC\_EnableIRQ}}(\mbox{\hyperlink{group___peripheral__interrupt__number__definition_gga7e1129cd8a196f4284d41db3e82ad5c8a9fb0ad0c850234d1983fafdb17378e2f}{EXTI15\_10\_IRQn}});\ }
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00061}00061\ \ \ \ \ \textcolor{comment}{//\ 인터럽트\ 발생\ Task\ 생성}}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00062}00062\ \ \ \ \ xTaskCreate(\mbox{\hyperlink{5__1__interrupt__timerdaemmon_8c_a59963d19b60052661ffcca0eccdc1244}{vPeriodicTask}},\ \textcolor{stringliteral}{"{}Periodic"{}},\ 512,\ NULL,\ (\mbox{\hyperlink{portmacro_8h_a646f89d4298e4f5afd522202b11cb2e6}{UBaseType\_t}})(\mbox{\hyperlink{_free_r_t_o_s_config_8h_a05c75ff9029ba3f0ab5bde9196f1e873}{configTIMER\_TASK\_PRIORITY}}\ -\/\ 1),\ NULL);}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00063}00063\ \ \ \ \ \mbox{\hyperlink{task_8h_aaf9dca1065c60abdeb309d56ab7293cb}{vTaskStartScheduler}}();}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00064}00064\ \ \ \ \ \textcolor{keywordflow}{while}\ (1);}
\DoxyCodeLine{\Hypertarget{5__1__interrupt__timerdaemmon_8c_source_l00065}00065\ \}}

\end{DoxyCode}
